from skopt import gp_minimize

space = [
    [2, 4, 6, 8],  # Layers
    [1, 2, 4, 6, 8, 16],  # Heads
    [64, 128, 256, 512, 1024],  # D_MODEL
    [128, 256, 512, 1024, 2048],  # DFF
    [0.1, 0.2, 0.25],  # Dropout
]

x0_l = [(6, 8, 128, 512, 0.2),
        (4, 8, 128, 256, 0.2),
        (4, 8, 256, 1024, 0.1),
        (6, 8, 512, 2048, 0.2),
        (6, 16, 128, 512, 0.1),
        (6, 4, 128, 512, 0.2),
        (8, 1, 128, 512, 0.2),
        (8, 8, 256, 2048, 0.2),
        (4, 4, 1024, 1024, 0.2),
        (8, 2, 128, 512, 0.1),
        (6, 4, 256, 256, 0.2)]

y0_l = [1.602, 1.603, 1.615, 1.624, 1.646, 1.6, 1.67, 1.655, 1.648, 1.61, 1.6]

x0_a = [(8, 16, 128, 2048, 0.1),
        (6, 4, 256, 256, 0.2),
        (6, 4, 256, 512, 0.2),
        (6, 4, 128, 256, 0.2),
        (6, 4, 64, 128, 0.2)]
y0_a = [6.253, 0.1385, 0.1479, 0.1311, 0.1619]


def func(inp):
    a, b, c, d, e = inp

    if c % b != 0:
        print("Invalid")
        return 10

    print(f"Calling with {a} Layers, {b} Heads, {c} D_MODEL, {d} DFF, {e} Dropout")
    return 0.2


r = gp_minimize(func, space, n_calls=10, n_initial_points=0, random_state=1, x0=x0_a, y0=y0_a, )
